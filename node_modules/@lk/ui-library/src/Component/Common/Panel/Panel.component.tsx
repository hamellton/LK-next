import React, { useState, useEffect } from "react";
import { DownArrow, UpArrow } from "../../../Icons";
import { TypographyENUM } from "../../../Types/general";
import { PanelType } from "./Panel.types";

import {
	PanelWrapper,
	TitleBox,
	TitleWrapper,
	Title,
	Subtitle,
	Content,
	ImageWrapper,
} from "./Panel.styles";
import { action } from "@storybook/addon-actions";

const Panel = ({
	children,
	title,
	expand,
	// handleClick,
	src,
	subtitle = "",
	isRTL = false,
}: PanelType) => {

	const [currentStatus, SetCurrentStatus] = useState(expand);

	useEffect(() => {
		SetCurrentStatus(expand);
	}, [expand]);

	const onTitleClick = (e: React.MouseEvent<HTMLElement, MouseEvent>, currentStatus:boolean) => {
		SetCurrentStatus(!currentStatus);
		// handleClick(!currentStatus);
		action("onTitleClick")(e, !currentStatus);
	};

	return (
		<PanelWrapper>
			<TitleBox onClick={ (e) => onTitleClick(e, currentStatus) } expand={currentStatus} isRTL={isRTL} styledFont={TypographyENUM.defaultBook}>
				{src && (
					<ImageWrapper>
						<img src={src}/>
					</ImageWrapper>
				)}
				<TitleWrapper isRTL={isRTL}>
					<Title>{title}</Title>
					{subtitle && !currentStatus && <Subtitle>{subtitle || ""}</Subtitle>}
				</TitleWrapper>
				<i>
					{!currentStatus ? <DownArrow/> : <UpArrow/>}
				</i>
			</TitleBox>
			{currentStatus && <Content isRTL={isRTL}>{children}</Content>}
		</PanelWrapper>
	);
};

export default Panel;
