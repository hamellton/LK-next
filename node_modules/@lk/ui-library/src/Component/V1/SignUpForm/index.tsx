import { action } from "@storybook/addon-actions";
import React from "react";
import { ComponentSizeENUM, ThemeENUM, TypographyENUM } from "../../../Types/general";
import FormInput from "../../Common/Input";
import { inputs } from "../../Common/Input/Input.types";
import PrimaryButton from "../../Common/PrimaryButton";
import { SignUpFormType } from "./SignUpForm.types";
import { AnchorTag, CheckboxInput, CheckboxLabel, ImageWhatsapp, InputWrapper, ReferralInputWrapper, ReferralText, ShowPasswordImage, SignUpFormContainer, UpdateOnWhatsappWrapper } from "./styles";

const SignUpForm = ({ id, dataLocale, onSignUp, font, isRTL=false }: SignUpFormType) => {
	const [formValue, setFormValue] = React.useState({
		firstName:"",
		lastName:"",
		mobile:"",
		emailAddress:"",
		password:"",
		referralCode:""
	});
	const [showReferralInput, setShowReferralInput] = React.useState(false);
	const [showPassword, setShowPassword] = React.useState(false);

	const onSubmit = (event: React.FormEvent<HTMLFormElement>) => {
		event.preventDefault();
		action("sign up form submitted")(event);
		const { firstName, lastName, mobile, emailAddress, password, referralCode } = formValue;
		onSignUp(emailAddress, firstName, lastName, mobile, password, "+91", referralCode);
	};

	const getUpdateOnWhatsapp = (event: React.ChangeEvent<HTMLInputElement>) => {
		action("get update on whatsapp")(event, { getUpdateOnWhatsapp:event.target.checked });
	};

	return <SignUpFormContainer id={id} onSubmit={onSubmit} styleFont={font}>
		<InputWrapper>
			<FormInput font={font} label={dataLocale.FIRST_NAME} onValueChange={(e) => setFormValue({ ...formValue, firstName:e.target.value })} width="100%" type={inputs.type.text} dir={inputs.type.dir} componentSize={ComponentSizeENUM.medium} isRTL={isRTL}/>
		</InputWrapper>
		<InputWrapper>
			<FormInput font={font} label={dataLocale.LAST_NAME} onValueChange={(e) => setFormValue({ ...formValue, lastName:e.target.value })} width="100%" type={inputs.type.text} componentSize={ComponentSizeENUM.medium} isRTL={isRTL} dir={inputs.type.dir}/>
		</InputWrapper>
		<InputWrapper>
			<FormInput font={font} countryCodePrefix="+91" label={dataLocale.MOBILE} onValueChange={(e) => setFormValue({ ...formValue, mobile:e.target.value })} width="100%" type={inputs.type.number} componentSize={ComponentSizeENUM.medium} isRTL={isRTL} dir={inputs.type.dir}/>
		</InputWrapper>
		<InputWrapper>
			<FormInput font={font} label={dataLocale.EMAIL_ADDRESS} onValueChange={(e) => setFormValue({ ...formValue, emailAddress:e.target.value })} width="100%" type={inputs.type.email} componentSize={ComponentSizeENUM.medium} isRTL={isRTL} dir={inputs.type.dir}/>
		</InputWrapper>
		<InputWrapper>
			<FormInput font={font} label={dataLocale.PASSWORD} onValueChange={(e) => setFormValue({ ...formValue, password:e.target.value })} width="100%" type={showPassword ? inputs.type.text : inputs.type.password} componentSize={ComponentSizeENUM.medium} isRTL={isRTL} dir={inputs.type.dir}/>
			<ShowPasswordImage showPassword={showPassword} onClick={() => setShowPassword(!showPassword)} src="https://static.lenskart.com/media/wysiwyg/sign-register/password-eye.png" isRTL={isRTL}/>
		</InputWrapper>
		<InputWrapper>
			{ showReferralInput ?
				<ReferralInputWrapper>
					{isRTL && (dataLocale.OPTIONAL)}
					<FormInput font={font} label={dataLocale.REFERRAL_CODE} onValueChange={(e) => setFormValue({ ...formValue, referralCode:e.target.value })} width="50%" type={inputs.type.text} componentSize={ComponentSizeENUM.medium} isRTL={isRTL} dir={inputs.type.dir}/>
					{!isRTL && (dataLocale.OPTIONAL)}
				</ReferralInputWrapper>
				:
				<ReferralText onClick={() => setShowReferralInput(true)} isRTL={isRTL}>{dataLocale.HAVE_REFERRAL}?</ReferralText>}
		</InputWrapper>
		<PrimaryButton onBtnClick={() => null} theme={ThemeENUM.primary} font={TypographyENUM.defaultBook} componentSize={ComponentSizeENUM.medium} id="btn-proceed" width="100%" height="35px" primaryText={dataLocale.REGISTER} />
		<UpdateOnWhatsappWrapper isRTL={isRTL}>
			<CheckboxInput type="checkbox" id="whatsapp-updates" onChange={getUpdateOnWhatsapp}/>
			<CheckboxLabel htmlFor="whatsapp-updates">{isRTL && <ImageWhatsapp src="	https://static.lenskart.com/media/desktop/img/25-July-19/whatsapp.png"/>} Get updates on Whatsapp {!isRTL && <ImageWhatsapp src="	https://static.lenskart.com/media/desktop/img/25-July-19/whatsapp.png"/>}</CheckboxLabel>
		</UpdateOnWhatsappWrapper>
		<AnchorTag href="//www.lenskart.com/terms-conditions" target="_blank">
			*{dataLocale.T_C_APPLY}
		</AnchorTag>
	</SignUpFormContainer>;
};

export default SignUpForm;
