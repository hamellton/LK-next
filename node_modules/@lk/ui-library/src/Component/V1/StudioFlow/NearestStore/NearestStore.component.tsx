import React, { useEffect } from "react";
import { animated, useSpring } from "react-spring";
import { Checkbox } from "../../../Common/Checkbox/Checkbox.component";
import {
	AddressSection,
	BottomSection,
	DetailsSection,
	Distance,
	Image,
	ImageContainer,
	Name,
	NameAndCheckbox,
	NearestStoreWrapper,
	TopSection,
} from "./NearestStore.styles";
import { NearestStorePropsType } from "./NearestStore.types";

const AnimatedNearestStoreWrapper = animated(NearestStoreWrapper);

function NearestStore({ store, isSelected, onClick, localeData }: NearestStorePropsType) {
	const [styles, api] = useSpring(() => ({
		background: "var(--white)",
		border: `1px solid ${"var(--white)"}`,
	}));
  
	useEffect(() => {
		if (isSelected) {
			api({
				background: "var(--ghost-white)",
				border: `1px solid ${"var(--dark-blue-50)"}`,
			});
		} else {
			api({
				background: "var(--white)",
				border: `1px solid ${"var(--white)"}`,
			});
		}
	}, [isSelected]);

	return (
		<AnimatedNearestStoreWrapper
			style={{
				background: styles.background,
				border: styles.border
			}}
			isSelected={isSelected}
			onClick={() => {
				onClick(store);
			}}
		>
			<TopSection>
				{/* TODO: When start getting store images from backend add it below and remove the falsy condition */}
				{false && <ImageContainer>
					<Image src="" alt={store.name} />
				</ImageContainer>}
				<DetailsSection>
					<NameAndCheckbox>
						<Name>{ store.name }</Name>
						<Checkbox
							checked={isSelected}
						/>
					</NameAndCheckbox>
					<AddressSection>
						{store.address}
					</AddressSection>
				</DetailsSection>
			</TopSection>
			{store?.geoDistance && <BottomSection>
				<Distance>{store?.geoDistance} {localeData.KM_AWAY as string}</Distance>
			</BottomSection>}
		</AnimatedNearestStoreWrapper>
	);
}

export { NearestStore };