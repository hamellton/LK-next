import React, { useEffect } from "react";
import ReactDOM from "react-dom";
import { animated, useTransition } from "react-spring";
import { AnchorText, Backdrop, Close, Content, KnowMoreContainer, ModalImage, ModalImageContainer, Text } from "./KnowMoreModal.styles";
import { KnowMoreModalTypes } from "./KnowMoreModal.types";

const AnimatedContent = animated(Content);
const AnimatedBackdrop = animated(Backdrop);

export default function KnowMoreModal({
	show,
	onHide,
	imagePath,
	url,
	cta
}: KnowMoreModalTypes) {
	const transitions = useTransition(show, {
		from: { opacity: 0, transform: "translate3d(0, -30%, 0)" },
		enter: { opacity: 1, transform: "translate3d(0, 0, 0)" },
		leave: { opacity: 0, transform: "translate3d(0, -30%, 0)" }
	});
  
	useEffect(() => {
		if (show) {
			document.body.style.overflow = "hidden";
		} else {
			document.body.style.overflow = "auto";
		}
		return () => {
			document.body.style.overflow = "auto";
		};
	},[show]);

	if (typeof window !== "undefined")
		return ReactDOM.createPortal(
			<>
				{transitions((animatedStyle, item) =>
					item && (
						<KnowMoreContainer>
							<AnimatedBackdrop
								style={{ opacity: animatedStyle.opacity }}
								onClick={() => {
									onHide();
								}}
							></AnimatedBackdrop>

							<AnimatedContent style={animatedStyle}>
								<Close
									onClick={() => {
										onHide();
									}}
								>
									<span>
										<img
											alt="close"
											src="https://static1.lenskart.com/media/desktop/img/DesignStudioIcons/CrossBlue.svg"
										/>
									</span>
								</Close>
								<ModalImageContainer>
									<ModalImage alt="know-more" src={imagePath} />
								</ModalImageContainer>
								<AnchorText
									href={new URL(url ?? "").pathname}
									rel="noreferrer"
									target="_blank"
								>
									<Text>{cta}</Text>
								</AnchorText>
							</AnimatedContent>
						</KnowMoreContainer>
					))}
			</>,
			document.body
		);
	else return null;
}
