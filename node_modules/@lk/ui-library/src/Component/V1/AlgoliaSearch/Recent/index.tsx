import React, { useState } from "react";
import { Icons } from "../../../..";
import { CardIconWrapper, CardImageWrapper, CardItemAction, CardItemContent, CardItemSeperator, CardItemTileWrapper, CardItemTitle, ProductContentWrapper, ProductDetail, ProductId } from "../common.styles";
import TypingLoader from "../Loader";


interface Hit {
    query: string;
    derivedName:string;
    thumbnailUrl:string;
  }
  interface RecentItemTypes {
    handleClick: () => void;
    hit: Hit;
  }

const RecentItem = ({ hit,handleClick }: RecentItemTypes) => {
	const [index, setIndex] = useState(-1);
	const recentItemClick = (event: React.MouseEvent<HTMLDivElement>) => {
		setIndex(1);
		handleClick();
		event.stopPropagation();
	};
	return (
		<>
			<CardItemTileWrapper onClick={recentItemClick} selected={index !== -1}>
				<CardItemContent>
					{!hit.derivedName ? (
						<CardIconWrapper>
							<Icons.Recent height={"20"} width={"20"} />
						</CardIconWrapper>
					) : (
						<CardImageWrapper
							selected={index != -1}
							src={
								hit.thumbnailUrl ??
                  "https://static1.lenskart.com/media/desktop/img/jul23/result/nores_svg.svg"
							}
							height={40}
							width={40}
							enableBorder={true}
							onError={(e: React.SyntheticEvent<HTMLImageElement, Event>) => {
								const target = e.target as HTMLImageElement;
								target.style.content =
                    "url('https://static1.lenskart.com/media/desktop/img/jul23/result/nores_svg.svg')";
							}}
						></CardImageWrapper>
					)}
					{!hit.derivedName ? (
						<CardItemTitle>{hit.query}</CardItemTitle>
					) : (
						<ProductContentWrapper>
							<ProductId>{hit.query}</ProductId>
							<ProductDetail>{hit.derivedName}</ProductDetail>
						</ProductContentWrapper>
					)}
				</CardItemContent>
				<CardItemAction>
					{index == -1 && <Icons.FillUp height={"12"} width={"12"} />}
					<TypingLoader show={index != -1} />
				</CardItemAction>
			</CardItemTileWrapper>
			<CardItemSeperator className="aa-item-seperator" />
		</>
	);
};

export default RecentItem;