import React, { useRef } from "react";
import Carousel from "../../../Common/Carousel";
import { RecentlyViewedProps } from "./RecentlyViewed.types";
import { Heading, ImgContainer, CustomButtons, ProductContainer, ProductImage, ProductLink, ProductName, ProductNameContainer, ProductPrice, ProductPriceContainer, RecentlyViewedWrapper, ProductDetail, ProductFeature, OfferText } from "./RecentlyViewed.styles";
// import { productDataLocale } from "./stories-data";
import { TypographyENUM } from "../../../../Types/general";
import { StrickOffText } from "../../Cart/CartCard/styles";
import { RatingStar } from "../../../Common/RatingStar/RatingStar.component";
import Slider from "react-slick";

function RecentlyViewed({ productList, isTaxable = false, dataLocale, font=TypographyENUM.defaultBook, titleFont=TypographyENUM.lkSansRegular, mobileView, slidesToShow, isRTL }: RecentlyViewedProps) {
	const { RECENTLY_VIEWED_PRODUCTS, ADD_ITEMS_FROM_YOUR_WISHLIST } = dataLocale;
	const defaultSlide = 1;
	const carouselRef = useRef<Slider>(null);
	console.log(carouselRef.current);
	return (
		<RecentlyViewedWrapper mobileView={mobileView} isRTL={isRTL}>
			<Heading mobileView={mobileView} styleFont={titleFont}>
				{productList[0]?.productImageUrl ? ADD_ITEMS_FROM_YOUR_WISHLIST : RECENTLY_VIEWED_PRODUCTS}
				{mobileView &&
					<CustomButtons>
						<span onClick={() => carouselRef.current?.slickPrev()}>
							<div>
								<img src="https://static1.lenskart.com/media/desktop/img/DesignStudioIcons/ArrowLeft.svg" />
							</div>
						</span>
						<span onClick={() => carouselRef.current?.slickNext()}>
							<div>
								<img src="https://static1.lenskart.com/media/desktop/img/DesignStudioIcons/ArrowRight.svg" />
							</div>
						</span>
					</CustomButtons>
				}
			</Heading>
			<Carousel slidesToShow={slidesToShow || 3} isRTL={false} wrapperClassName="slider-custom" ref={carouselRef} mobileView={mobileView}>
				{productList.map((product, index) => (
					<Carousel.Slide id={index} currentSlide={defaultSlide} key={index}>
						<ProductContainer mobileView={mobileView} styleFont={font} isRTL={isRTL}>
							<ProductLink href={product.productUrl} target={"_blank"} rel={"noreferrer"}>
								<ImgContainer>
									<ProductImage src={product.imageUrl || product.productImageUrl} alt={product.brandName} />
									<RatingStar recentlyViewed={true} rating={product.avgRating ? parseFloat(product.avgRating) : 0} id={"rating-star"} font={TypographyENUM.lkSansRegular} backgroundColor={"#EEEEF5"} primaryTextColor={"#000042"} starColor={"#0FBD95"}/>
								</ImgContainer>
								<ProductDetail>
									<ProductNameContainer isRTL>
										<ProductName>{product.brandName}</ProductName>
									</ProductNameContainer>
									{product.productName && <ProductFeature>
										<span title={product.productName}>{product.productName}</span>
									</ProductFeature>}
									<ProductPriceContainer isRTL>
										<ProductPrice>
											{product?.prices?.symbol + " " + product?.prices?.lkPrice}{" "}
											{product?.productImageUrl && product?.prices?.lkPrice !== product.prices.basePrice ? <StrickOffText isRTL={false}>{product?.prices?.symbol + " " + product?.prices?.basePrice}</StrickOffText> : ""}
											{isTaxable && <span style={{ color: "var(--dark-blue-10)", fontSize: "12px" }}> (+ tax)</span>}
											{product.offer && <OfferText>{product.offer}% off</OfferText>}
										</ProductPrice>
									</ProductPriceContainer>
								</ProductDetail>
							</ProductLink>
						</ProductContainer>
					</Carousel.Slide>
				))}
			</Carousel>
		</RecentlyViewedWrapper>
	);
}

export { RecentlyViewed };
