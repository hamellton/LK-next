import React from "react";
import { CompletePaymentheader, CompltePaymentWrapper, CompletePaymentText, CompltePaymentSubText, PayNowButton } from "../styles";
import { CompleteStudioBookingTypes } from "./types";
import { formatDate } from "../utils";

const CompleteStudioBooking = ({ dataLocale, handleStudioFlowAppointmentClick, mobileView = false, orderData }: CompleteStudioBookingTypes) => {

	const { CHANGE, BOOK_APPOINTMENT, PLEASE_SELECT_DATE_AND_TIME_SLOT, APPOINTMENT_BOOKED, BOOK_NOW } = dataLocale || {};

	const bookDetails = (orderData: any) =>
		`${formatDate(Date.parse(orderData.studioBookingDetails.date), "D MMM", "")},
              ${`${orderData?.studioBookingDetails?.startTime?.split(":")?.slice(0, 2)?.join(":")}`} -
              ${`${orderData?.studioBookingDetails?.endTime?.split(":")?.slice(0, 2)?.join(":")}`} ${
	"studioStoreDetails" in orderData
		? `, ${orderData.studioStoreDetails.name || orderData.shippingAddress.firstName}`
		: ""
}`;

	const handleOnCtaClick = () => {
		handleStudioFlowAppointmentClick("studioBookingDetails" in orderData, orderData?.studioStoreDetails?.code || "", orderData.id);
	};


	return (
		<CompltePaymentWrapper mobileView={mobileView}>
			{"studioBookingDetails" in orderData ? (
				<>
					<CompletePaymentheader>
						<CompletePaymentText mobileView={mobileView}>{ APPOINTMENT_BOOKED?.toLowerCase() }</CompletePaymentText>
						<CompltePaymentSubText mobileView={mobileView}>{bookDetails(orderData)}</CompltePaymentSubText>
					</CompletePaymentheader>
					<PayNowButton mobileView={mobileView} onClick={() => handleOnCtaClick()}>{ CHANGE }</PayNowButton>
				</>
			) : (
				<>
					<CompletePaymentheader>
						<CompletePaymentText mobileView={mobileView}>{ BOOK_APPOINTMENT?.toLowerCase() }</CompletePaymentText>
						<CompltePaymentSubText mobileView={mobileView}>{ PLEASE_SELECT_DATE_AND_TIME_SLOT }</CompltePaymentSubText>
					</CompletePaymentheader>
					<PayNowButton mobileView={mobileView} onClick={() => handleOnCtaClick()}>{ BOOK_NOW }</PayNowButton>
				</>
			)}
		</CompltePaymentWrapper>
	);
};

export default CompleteStudioBooking;
