import React, { useEffect } from "react";
import * as Icons from "../../../Icons/index";
import BottomSheet from "../../Mobile/BottomSheet/BottomSheet.component";
import BuyOnCallWidget from "../BuyOnCallWidget";
import { GridConfigrationTypes } from "./GridConfigration.types";
import { BottomSheetWrapper, Heading, IconWrapper, HeadingIconWrapper, LinkProvider, Image, BottomSheetBanner } from "./styles";

const GridConfigration = ({ bottomSheetData, categoryCardsType, showBottomSheet, openBottomSheet, buyWithCallConfig, category, whatsAppChatMsg, triggerGAPromotion, handleOnBuyOnChatClick }: GridConfigrationTypes) => {

	useEffect(() => { 
		if (Array.isArray(bottomSheetData) && showBottomSheet) {
			bottomSheetData.map((unit: any) => triggerGAPromotion(unit?.gaPromotionObj, true)); // view-promotion
		}
		showBottomSheet && (document.body.style.overflow = "hidden");
		!showBottomSheet && (document.body.style.overflow = "auto");
	}, [showBottomSheet]);

	const onClickBackdrop = () => {
		openBottomSheet(false);
	};
	const closebottomSheet = () => {
		openBottomSheet(false);
	};
	const clickBannerPassDTM = (dtmObj: any) => {
		console.log(dtmObj);
	};
	const onClickBannerPassGaObj = (gaObj: any) => {
		triggerGAPromotion(gaObj); // select-promotion
	};
	return (
		<BottomSheet
			backdrop
			show={showBottomSheet}
			onClickBackdrop={onClickBackdrop}
			expanded={showBottomSheet}
			addTopRadius={true}
			sixOverSix={false}
			addressEditOrderDetail={false}
			borderRadius={true}
			closebottomSheet={closebottomSheet}
		>
			<BottomSheetWrapper>
				<HeadingIconWrapper>
					<IconWrapper onClick={() => closebottomSheet()}>
						<Icons.Cross />
					</IconWrapper>
					<Heading>{categoryCardsType}</Heading>
				</HeadingIconWrapper>
				{bottomSheetData && bottomSheetData.map((unit: any, i: number) => {
					return (
						<BottomSheetBanner
							key={`grid-child-${i}`}
							className="display-flex align-items-center justify-space-between text-left bg-color_white mr-t10 bora-4 "
							onClick={() => clickBannerPassDTM(unit.dtmObj)}
						>
							<LinkProvider href={unit.url}>
								<Image
									className="ga-banner-img-obeserver"
									alt={`img-${i}`}
									onClick={() => onClickBannerPassGaObj(unit.gaPromotionObj)}
									src={unit.image}
								></Image>
							</LinkProvider>
						</BottomSheetBanner>
					);
				})}
				{buyWithCallConfig && buyWithCallConfig.enabled && (
					<BuyOnCallWidget
						buyWithCallConfig={buyWithCallConfig}
						category={category}
						whatsAppChatMsg={whatsAppChatMsg}
						onClickHandler={handleOnBuyOnChatClick}
					/>
				)}
			</BottomSheetWrapper>
		</BottomSheet>
	);
};

export default GridConfigration;