import React, { useEffect, useState } from "react";
import { RightSectionType } from "./RightSection.types";
import { Cross, Head, HeadContainer, Icon, RightBottom, RightSectionContainer, RightTop, SequenceContainer, SqBottomText, SqDividerLine, SqHolder, SqTextContainer, SqTopText } from "./styles";

const RightSection = ({
	id,
	heading = "Select Packages",
	sequences,
	onClosePackages,
	backButton,
	children
}: RightSectionType) => {

	const [activePackage, setActivePackage] = useState(0);
	const [selectedText, setSelectedText] = useState("");

	useEffect(() => {
		sequences.forEach((element, index) => {
			if(element.isActive){
				setActivePackage(index);
			}
		});
		setSelectedText(sequences[0]?.selectedText);
	}, [sequences]);

	console.log(activePackage,"   activepackage");
	
	return (
		<RightSectionContainer id={id}>
			<RightTop>
				<HeadContainer>
					{activePackage > 0 && <Icon src="https://preprod.lenskart.com/assets/svg/Vector.svg" onClick={() => backButton(activePackage-1)} alt="vector"/>}
					<Head>{heading}</Head>
					<Cross alt="close" src="https://www.lenskart.com/assets/svg/Cross.svg" onClick={onClosePackages} />
				</HeadContainer>
				<SequenceContainer>
					{sequences.map((sq, i) => <SqHolder key={i} hide={Boolean(selectedText && selectedText.length && selectedText === "Zero Power" && i===2) }>
						<SqTextContainer enabled={sq.showSection} currentlySelected={sq.isActive} onClick={()=> {
							backButton(i);
						}}>
							{sq.heading && <SqTopText>{sq.heading}</SqTopText>}
							<SqBottomText currentlySelected={sq.isActive}>{sq.selectedText}</SqBottomText>
						</SqTextContainer>
						{i < (selectedText === "Zero Power" ? (sequences.length - 2) : (sequences.length - 1)) && <SqDividerLine hasTopText={Boolean(sq.selectedText)}/>}
					</SqHolder>)}
				</SequenceContainer>
			</RightTop>
			<RightBottom>
				{children}
				{/* <PackageRadioGroup id="image-radio-id" prescriptionTypeData={prescriptionTypeData} selectedId={selectedId} onChange={onPackageClicked} radioWidth={100} /> */}
			</RightBottom>
		</RightSectionContainer>
	);
};

export default RightSection;
